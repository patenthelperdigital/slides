---
title: "Команда [pHd]{style=\"color: rgb(83, 29, 171); \"} <br> решила задачу [№1]{style=\"color: rgb(83, 29, 171); \"} на ЛЦТ-2024"
subtitle: "И сейчас расскажет вам, что получилось"
format: revealjs
---

# Команда pHd — это:

- бэк Дима
- фронт Оля
- бэк и дата-сатанист Паша
- продакт Юля

# Задача

## Патент {.scrollable .nostretch}

![](images/patent.png){width="100%"}

## Патентообладатель

![](images/patent-holder.png)

## Проблема

1. Есть имя или наименование патентообладателя
2. [Нет ИНН]{style="color: rgb(83, 29, 171);"}
3. Из-за этого сложно сопоставлять данные с другими источниками и анализировать их

## Пошли решать

![](images/we-will-win.jpg)

## Не так быстро

![](images/mordor.jpg)

## Сложности {.scrollable .nostretch}

![](images/complexity.jpg){width="100%"}

## Примеры проблем с поиском {.scrollable}

- Открытое акционерное общество "Научно-исследовательский проектно-конструкторский и технологический институт электромашиностроения" (RU) — уже не «открытое» и к тому же «всероссийское»
- Самойленко Евгений Николаевич — их как минимум двое
- Смелова Эдельвена яковлевна — это физлицо без публичного ИНН
- Воронежский институт «Гипрокаучук» — его нет и никогда не существовало под таким именем (неофициальное название филиала)

# Цель

Найти хотя бы половину ИНН, а лучше — ещё больше

# Решение

## Попытка №1: Pandas

![](images/memory.jpg)

## Попытка №2: Postgres

![](images/zhdun.jpg)

## Попытка №3: векторы

![](images/vectors.jpg)

## Попытка №4: внешние сервисы

![](images/money.jpg)

## Попытка #5: Кликхаус

Вдруг и правда «не тормозит»?

![](images/ch.png)

## Наш алгоритм {.scrollable}

1. Загружаем базу для поиска в Кликхаус, убираем лишнее, добавляем индексы.
2. Чистим базу патентов: пропускаем зарубежных патентообладателей, «раскавычиваем» названия, «склеиваем» разбитые на несколько строк, убираем коды стран.
3. Ищем в Кликхаусе по [точному совпадению]{style="color: rgb(83, 29, 171); "} названия, ранжируем по 4gram distance адресов.
4. Ищем в Кликхаусе по [вхождению]{style="color: rgb(83, 29, 171); "} названия, ранжируем по 4gram distance названий и адресов.
5. Ищем в Кликхаусе по [пересечению множеств токенов]{style="color: rgb(83, 29, 171); "} в названиях, ранжируем по 4gram distance названий и адресов.
6. Покупаем мощную ВМ на Клауде и за двое суток обрабатываем всю базу патентов.
7. Проверяем, грузим на бэк, прикручиваем интерфейс и аналитику.

## Всё остальное

- Бэк: Python + FastAPI + Postgres
- Фронтенд: React + Vite

# Результаты

## По всей базе

- ИНН нашлись для [84%]{style="color: rgb(83, 29, 171); "} патентов
- Правильно или нет, не знаем, так как не с чём сравнивать
- Скорость — [16 000]{style="color: rgb(83, 29, 171); "} патентов в час (4vCPU + 8Гб + SSD)

## Выборочная самопроверка

```{r}
val_stat <- data.frame(
  inv = c(77, 82),
  mod = c(88, 64),
  des = c(95, 68),
  row.names = c("Найдено (%)", "Точность по юрлицам (%)")
)
knitr::kable(
  val_stat,
  col.names = c("Изобр.", "Модели", "Образцы")
)
```

*n* = 100 по каждому типу патента

## Демо приложения

[app.patenthelper.digital](http://app.patenthelper.digital){preview-link="true}

![](images/show.jpg)

# Будущее

![](images/future.png)

Но у нас было только две недели :)
